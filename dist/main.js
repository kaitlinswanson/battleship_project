document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelector(".grid-user"),t=document.querySelector(".grid-computer"),n=document.querySelector(".grid-display"),s=document.querySelectorAll(".ship"),i=document.querySelector(".destroyer-container"),r=document.querySelector(".submarine-container"),o=document.querySelector(".cruiser-container"),a=document.querySelector(".battleship-container"),c=document.querySelector(".carrier-container"),d=document.getElementById("start"),l=document.getElementById("rotate"),u=document.getElementById("turn");document.getElementById("message");let m=!0,L=!1,h="user";const p=[],f=[],g=10;function y(e,t,n){for(let s=0;s<n*n;s++){const n=document.createElement("div");n.dataset.id=s,e.appendChild(n),t.push(n)}}y(e,p,g),y(t,f,g);const v=[{name:"destroyer",directions:[[0,1],[0,g]]},{name:"submarine",directions:[[0,1,2],[0,g,20]]},{name:"cruiser",directions:[[0,1,2],[0,g,20]]},{name:"battleship",directions:[[0,1,2,3],[0,g,20,30]]},{name:"carrier",directions:[[0,1,2,3,4],[0,g,20,30,40]]}];function E(e){let t=Math.floor(Math.random()*e.directions.length),n=e.directions[t];0===t&&(direction=1),1===t&&(direction=10);let s=Math.abs(Math.floor(Math.random()*f.length-e.directions[0].length*direction));const i=n.some((e=>f[s+e].classList.contains("taken"))),r=n.some((e=>(s+e)%g==9)),o=n.some((e=>(s+e)%g==0));i||r||o?E(e):n.forEach((t=>f[s+t].classList.add("taken",e.name)))}let b,M,k;function T(){M=this,k=this.childNodes.length}function H(e){e.preventDefault()}function I(e){e.preventDefault()}function S(){console.log("drag leave")}function Y(){let e=M.lastChild.id,t=e.slice(0,-2);console.log(t);let s=parseInt(e.substr(-1)),i=s+parseInt(this.dataset.id),r=[0,10,20,30,40,50,60,70,80,90,1,11,21,31,41,51,61,71,81,91,2,22,32,42,52,62,72,82,92,3,13,23,33,43,53,63,73,83,93].splice(0,10*s),o=[99,98,97,96,95,94,93,92,91,90,89,87,86,85,84,83,82,81,80,79,78,77,76,75,74,73,72,71,70,69,68,67,66,65,64,63,62,61,60].splice(0,10*s);if(selectedShipIndex=parseInt(b.substr(-1)),i-=selectedShipIndex,console.log(i),m&&!r.includes(i))for(let e=0;e<k;e++)p[parseInt(this.dataset.id)-selectedShipIndex+e].classList.add("taken",t);else{if(m||o.includes(i))return;for(let e=0;e<k;e++)p[parseInt(this.dataset.id)-selectedShipIndex+g*e].classList.add("taken",t)}n.removeChild(M)}function q(){console.log("dragend")}function D(){2===C&&(infoDisplay.innerHTML="You sunk the computers destroyer",C=10),3===x&&(info.display.innerHTML="You sunk the computers submarine",x=10),3===B&&(info.display.innerHTML="You sunk the computers cruiser",B=10),4===W&&(info.display.innerHTML="You sunk the computers battleship",W=10),5===w&&(info.display.innerHTML="You sunk the computers carrier",w=10),2===A&&(infoDisplay.innerHTML="You sunk the computers destroyer",cpuDestroyreCount=10),3===N&&(info.display.innerHTML="You sunk the computers submarine",N=10),3===O&&(info.display.innerHTML="You sunk the computers cruiser",O=10),4===j&&(info.display.innerHTML="You sunk the computers battleship",j=10),5===z&&(info.display.innerHTML="You sunk the computers carrier",z=10),C+x+B+W+w===50&&(infoDisplay.innerHTML="You Win!",G()),A+N+O+j+z===50&&(infoDisplay.innerHTML="Computer Wins!",G()),(L=!0)&&G(),"user"===h&&(u.innerHTML="Your Turn!",f.forEach((e=>e.addEventListener("click",(function(t){!function(e){e.classList.contains("boom")&&(e.classList.contains("destroyer")&&C++,e.classList.contains("submarine")&&x++,e.classList.contains("cruiser")&&B++,e.classList.contains("battleship")&&W++,e.classList.contains("carrier")&&w++),e.classList.contains("taken")?e.classList.add("boom"):e.classList.add("miss"),h="computer",D()}(e)}))))),"computer"===h&&(u.innerHTML="Computers Turn!",setTimeout(F,1e3))}E(v[0]),E(v[1]),E(v[2]),E(v[3]),E(v[4]),l.addEventListener("click",(function(){return m?(i.classList.toggle("destroyer-container-vertical"),r.classList.toggle("submarine-container-vertical"),o.classList.toggle("cruiser-container-vertical"),a.classList.toggle("battleship-container-vertical"),c.classList.toggle("carrier-container-vertical"),void(m=!1)):m?void 0:(i.classList.toggle("destroyer-container"),r.classList.toggle("submarine-container"),o.classList.toggle("cruiser-container"),a.classList.toggle("battleship-container"),c.classList.toggle("carrier-container"),void(m=!0))})),s.forEach((e=>e.addEventListener("dragstart",T))),p.forEach((e=>e.addEventListener("dragstart",T))),p.forEach((e=>e.addEventListener("dragover",H))),p.forEach((e=>e.addEventListener("dragenter",I))),p.forEach((e=>e.addEventListener("dragleave",S))),p.forEach((e=>e.addEventListener("drop",Y))),p.forEach((e=>e.addEventListener("dragend",q))),s.forEach((e=>e.addEventListener("mousedown",(e=>{b=e.target.id})))),d.addEventListener("click",D);let C=0,x=0,B=0,W=0,w=0,A=0,N=0,O=0,j=0,z=0;function F(){let e=Math.floor(Math.random()*p.length);p[e].classList.contains("boom")?F():(p[e].classList.add("boom"),p[e].classList.contains("destroyer")&&A++,p[e].classList.contains("submarine")&&N++,p[e].classList.contains("cruiser")&&O++,p[e].classList.contains("battleship")&&j++,p[e].classList.contains("carrier")&&z++),h="user",u.innerHTML="Your Turn",checkforWin()}function G(){L=!0,d.removeEventListener("click",D)}}));